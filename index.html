<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dialogflow Messenger Chat</title>
    <script nonce="my-nonce-value" src="https://static.dialogflow.com/common/messenger/webcomponentsjs/2.1.3/custom-elements-es5-adapter.js"></script>
    <script nonce="my-nonce-value" src="https://static.dialogflow.com/common/messenger/webcomponentsjs/2.1.3/webcomponents-loader.js"></script>
    <script nonce="my-nonce-value">
        (function (global) {
            'use strict';
            const agentId = "my-agent-id";
            const languageCode = "en";
            const chatTitle = "Dialogflow Messenger Chat";
            const backgroundColor = "#FFFFFF";
            const fontColor = "#000000";
            const nonce = window['dfBootstrapNonce'];

            var messengerUrl =
                'https://www.gstatic.com/dialogflow-console/fast/messenger/messenger-internal.min.js?v=4';

            var loadDfMessenger = function () {
                var elementScript = document.createElement('script');
                elementScript.addEventListener('load', onMessengerLoaded, false);
                elementScript.src = messengerUrl;
                if (nonce) {
                    elementScript.setAttribute('nonce', nonce);
                }
                global.document.body.insertBefore(elementScript, null);
            };

            var onMessengerLoaded = function () {
                window.dispatchEvent(new Event('dfMessengerLoaded'))
            };

            var loadWebComponentPolyfills = function () {
                var customElementsAdapterTag = document.createElement('script');
                if (global.customElements) {
                    // Import custom elements adapter which is needed for Custom element
                    // classes transpiled to ES5.
                    customElementsAdapterTag.src = 'https://static.dialogflow.com/common/messenger/webcomponentsjs/2.1.3/custom-elements-es5-adapter.js';
                    if (nonce) {
                        customElementsAdapterTag.setAttribute('nonce', nonce);
                    }
                    document.head.appendChild(customElementsAdapterTag);
                }
                // Import web components loader which loads polyfills based on browser
                // support.
                const webComponentsLoaderTag = document.createElement('script');
                webComponentsLoaderTag.src = 'https://static.dialogflow.com/common/messenger/webcomponentsjs/2.1.3/webcomponents-loader.js';
                if (nonce) {
                    webComponentsLoaderTag.setAttribute('nonce', nonce);
                }
                global.document.head.appendChild(webComponentsLoaderTag);
            };

            global.addEventListener('WebComponentsReady', loadDfMessenger, false);

            var raf = global.requestAnimationFrame || global.mozRequestAnimationFrame ||
                global.webkitRequestAnimationFrame || global.msRequestAnimationFrame;
            if (raf) {
                raf(function () {
                    global.setTimeout(loadWebComponentPolyfills, 0);
                });
            } else {
                global.addEventListener('load', loadWebComponentPolyfills);
            }
        })(window);
    </script>
</head>
<body>
<df-messenger
        intent="WELCOME"
        chat-title="Dialogflow Messenger Chat"
        agent-id="my-agent-id"
        language-code="en"
        background-color="#FFFFFF"
        font-color="#000000"
></df-messenger>
</body>
</html>
